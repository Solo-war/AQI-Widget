# AQI Widget

Настольный виджет на Electron, показывающий качество воздуха (AQI) и концентрации PM2.5/PM10 для выбранной станции WAQI.

## Возможности
- Текущий AQI, PM2.5 и PM10 (если доступны).
- Адрес станции и время последнего обновления.
- Автообновление каждые 10 минут + кнопка «Обновить».
- Автозапуск при входе в Windows.
- Глобальная горячая клавиша для показа окна: `Ctrl+Alt+Q`.
- Цвет верхней панели зависит от уровня AQI. Иконка приложения тоже обновляется.

## Установка и запуск
1. Установите зависимости:
   ```bash
   npm install
   ```
2. Создайте `.env` в корне проекта (см. пример `.env.example`) и задайте переменные:
   ```env
   WAQI_TOKEN=ваш_токен_WAQI
   WAQI_STATION=A377965
   ```
3. Запустите приложение в режиме разработки:
   ```bash
   npm start
   ```

## Как получить токен WAQI и ID станции
- Токен: зарегистрируйтесь на сайте [WAQI](https://aqicn.org/) и получите API‑ключ.
- ID станции: на странице станции посмотрите её идентификатор (или используйте геопоиск WAQI API).

## Переменные окружения
- `WAQI_TOKEN` — токен API WAQI (обязательно).
- `WAQI_STATION` — ID станции WAQI (по умолчанию `A377965`).

Прокси (опционально, для Hiddify):
- `HIDDIFY_MODE` — режим: `follow-system` | `force` | `off` (по умолчанию `follow-system`).
- `HIDDIFY_PROXY` — адрес прокси, например `http://127.0.0.1:7890` (используется в режиме `force`).
- `HIDDIFY_PROXY_BYPASS` — список исключений (через `;`).
- `HIDDIFY_SET_SYSTEM_PROXY` — `true/false`, менять ли системный прокси Windows (только при `HIDDIFY_MODE=force`).

## Сборка
Сборка установочного пакета:
```bash
npm run build
```

## Примечания по безопасности
- Включён строгий CSP: внешние скрипты/стили запрещены, соединения только к `https://api.waqi.info`.
- Изоляция контекста включена; IPC минимален.

## Источник данных
Приложение использует API [World Air Quality Index (WAQI)](https://aqicn.org/). Возможны задержки/лимиты API. Использование данных — на вашей ответственности.

## Лицензия
MIT

### Автозапуск
- В режиме разработки (запуск через `npm start`) автозапуск отключён и при старте приложения будет автоматически удалён. Это предотвращает появление «пустых» окон Electron после перезагрузки.
- В собранной версии автозапуск можно включить из меню трея. В этом случае запускается именно приложение, а не `electron.exe` без аргументов.
- Если после прошлых экспериментов при входе в систему открываются лишние окна Electron — запустите приложение один раз (оно удалит некорректную запись). Затем перезагрузитесь. Также проверьте Диспетчер задач → Автозагрузка и отключите запись «Electron», если она есть.
